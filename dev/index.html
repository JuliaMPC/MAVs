<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · MAVs</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/><link href="assets/style.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>MAVs</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Home</a><ul class="internal"><li><a class="toctext" href="#Features-1">Features</a></li><li><a class="toctext" href="#Installation-Instructions-1">Installation Instructions</a></li><li><a class="toctext" href="#Citation-1">Citation</a></li></ul></li><li><span class="toctext">Usage</span><ul><li><a class="toctext" href="tutorials/basic/">Basic usage</a></li><li><a class="toctext" href="tutorials/developer/">Developing MAVs</a></li></ul></li><li><span class="toctext">Sensing</span><ul><li><a class="toctext" href="packages/model/gazebo/vehicle_description/main/">vehicle_description</a></li><li><a class="toctext" href="packages/model/gazebo/contact_sensor/main/">contact_sensor</a></li></ul></li><li><span class="toctext">Detection</span><ul><li><a class="toctext" href="packages/computing/perception/obstacle_detector/main/">obstacle_detector</a></li></ul></li><li><span class="toctext">Vehicle model</span><ul><li><a class="toctext" href="packages/model/chrono/ros_chrono/main/">ros_chrono</a></li></ul></li><li><span class="toctext">Planning</span><ul><li><a class="toctext" href="packages/computing/planning/nloptcontrol_planner/main/">nloptcontrol_planner</a></li><li><a class="toctext" href="packages/computing/planning/mavs_ros_planner/main/">mavs<em>ros</em>planner</a></li></ul></li><li><span class="toctext">Controller</span><ul><li><a class="toctext" href="packages/computing/controller/path_follower/main/">path_follower</a></li><li><a class="toctext" href="packages/computing/controller/trajectory_follower/main/">trajectory_follower</a></li></ul></li><li><span class="toctext">Miscellaneous</span><ul><li><a class="toctext" href="packages/system/system_shutdown/">system_shutdown</a></li><li><a class="toctext" href="packages/system/data_logging/">data_logging</a></li><li><a class="toctext" href="packages/model/chrono/chrono_position_broadcaster/main/">chrono<em>position</em>broadcaster</a></li><li><a class="toctext" href="packages/computing/perception/point_cloud_converter/">point<em>cloud</em>converter</a></li></ul></li><li><span class="toctext">System demos</span><ul><li><a class="toctext" href="packages/system/demos/demoA/">demoA</a></li><li><a class="toctext" href="packages/system/demos/demoB/">demoB</a></li><li><a class="toctext" href="packages/system/demos/demoI/">demoI</a></li><li><a class="toctext" href="packages/system/demos/demoM/">demoM</a></li><li><a class="toctext" href="packages/system/demos/demoK/">demoK</a></li><li><a class="toctext" href="packages/system/demos/demoZ/">demoZ</a></li></ul></li><li><span class="toctext">Docker</span><ul><li><a class="toctext" href="docker/workflow/">Workflow</a></li><li><a class="toctext" href="docker/notes/">Notes</a></li></ul></li><li><a class="toctext" href="testing/main/">Testing</a></li><li><a class="toctext" href="issues/main/">Troubleshooting</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Home</a></li></ul><a class="edit-page" href="https://github.com/JuliaMPC/MAVs/blob/master/docs/src/index.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Home</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="MAVs-Documentation-1" href="#MAVs-Documentation-1">MAVs Documentation</a></h1><p>This software simulates an autonomous vehicle within a ROS environment.</p><h2><a class="nav-anchor" id="Features-1" href="#Features-1">Features</a></h2><ul><li>nonlinear model predictive control through <a href="https://github.com/JuliaMPC/NLOptControl.jl">NLOptControl.jl</a></li><li>lidar simulation through Gazebo</li><li>vehicle model through Chrono</li></ul><h2><a class="nav-anchor" id="Installation-Instructions-1" href="#Installation-Instructions-1">Installation Instructions</a></h2><p>These instructions depend on your machine&#39;s configuration.</p><h3><a class="nav-anchor" id="Step-1,-Install-Docker-1" href="#Step-1,-Install-Docker-1">Step 1, Install Docker</a></h3><p>Remove any old versions of docker <em>if</em> they are on your machine:</p><pre><code class="language-none">sudo apt-get remove docker docker-engine docker.io</code></pre><p>Update the apt package index:</p><pre><code class="language-none">sudo apt-get update</code></pre><p>Install the packages to allow apt to use a repository through HTTPS:</p><pre><code class="language-none">sudo apt-get install \
   apt-transport-https \
   ca-certificates \
   curl \
   software-properties-common</code></pre><p>Add the official GPG key of Docker:</p><pre><code class="language-none">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</code></pre><p>Verify that the command below print out 9DC8 5822 9FC7 DD38 854A E2D8 8D81 803C 0EBF CD88:</p><pre><code class="language-none">sudo apt-key fingerprint 0EBFCD88</code></pre><p>Tell apt to use the stable repository by running the command below:</p><pre><code class="language-none">sudo add-apt-repository \
   &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu \
   $(lsb_release -cs) \
   stable&quot;</code></pre><p>Update the apt package index and install Docker CE:</p><pre><code class="language-none">sudo apt-get update &amp;&amp; apt-get install docker-ce</code></pre><p>Check installation of docker:</p><pre><code class="language-none">docker run hello-world</code></pre><p><a href="docker.png">Expected output</a></p><h3><a class="nav-anchor" id="Step-2,-Update-NVIDIA-Driver-1" href="#Step-2,-Update-NVIDIA-Driver-1">Step 2, Update NVIDIA Driver</a></h3><p>Use the <a href="https://developer.nvidia.com/cuda-downloads ">CUDA 10.1 Toolkit</a> to install CUDA. An example of using this toolkit follows.</p><p><img src="platform.png" alt="First, select your machine architecture"/></p><p><img src="download.png" alt="Next, download the .deb file provided"/></p><p>After the download is complete, cd into your <span>$~\Downloads$</span> folder and follow the installation instructions provided by the toolkit to install CUDA:</p><pre><code class="language-none">sudo dpkg -i $HOME/Downloads/cuda-repo-ubuntu1604-10-1-local-10.1.105-418.39_1.0-1_amd64.deb
sudo apt-key add /var/cuda-repo-&lt;version&gt;/7fa2af80.pub
sudo apt-get update
sudo apt-get install cuda</code></pre><p><em>Note:</em> After you follow the first instruction, the <code>&lt;version&gt;</code> in the second instruction will be provided. For instance, in this example:</p><pre><code class="language-none">$HOME/Downloads/cuda-repo-ubuntu1604-10-1-local-10.1.105-418.39_1.0-1_amd64.deb</code></pre><p>Produces:</p><pre><code class="language-none">Selecting previously unselected package cuda-repo-ubuntu1604-10-1-local-10.1.105-418.39.
(Reading database ... 551128 files and directories currently installed.)
Preparing to unpack .../cuda-repo-ubuntu1604-10-1-local-10.1.105-418.39_1.0-1_amd64.deb ...
Unpacking cuda-repo-ubuntu1604-10-1-local-10.1.105-418.39 (1.0-1) ...
Setting up cuda-repo-ubuntu1604-10-1-local-10.1.105-418.39 (1.0-1) ...

The public CUDA GPG key does not appear to be installed.
To install the key, run this command:
sudo apt-key add /var/cuda-repo-10-1-local-10.1.105-418.39/7fa2af80.pub</code></pre><p>Thus add the key as instructed, before proceeding with the final instructions.</p><p><em>Reboot your computer and verify that the NVIDIA graphics driver can be loaded</em></p><h3><a class="nav-anchor" id="Step-3,-Install-NVIDIA-docker-1" href="#Step-3,-Install-NVIDIA-docker-1">Step 3, Install NVIDIA-docker</a></h3><p><em>If</em> installed, remove NVIDIA docker 1.0:</p><pre><code class="language-none">docker volume ls -q -f driver=nvidia-docker | xargs -r -I{} -n1 docker ps -q -a -f volume={} | xargs -r docker rm -f
sudo apt-get purge -y nvidia-docker</code></pre><p>Add the necessary repositories and update the apt package index:</p><pre><code class="language-none">curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | \
  sudo apt-key add -
curl -s -L https://nvidia.github.io/nvidia-docker/ubuntu16.04/amd64/nvidia-docker.list | \
  sudo tee /etc/apt/sources.list.d/nvidia-docker.list
sudo apt-get update</code></pre><p>Install NVIDIA docker:</p><pre><code class="language-none">sudo apt-get install -y nvidia-docker2
sudo pkill -SIGHUP dockerd</code></pre><p>Test NVIDIA docker installation:</p><pre><code class="language-none">docker run --runtime=nvidia --rm nvidia/cuda nvidia-smi</code></pre><p><a href="nvidia.png">Expected output</a></p><h3><a class="nav-anchor" id="Step-4,-Install-MAVs-1" href="#Step-4,-Install-MAVs-1">Step 4, Install MAVs</a></h3><ol><li><p>Make a directory to store MAVs in, e.g., <span>$$HOME/Documents/workspace/MAVs$</span>. cd into that directory.</p></li><li><p>Clone the <code>develop</code> branch of the repository</p></li></ol><pre><code class="language-none">git clone -b develop https://github.com/JuliaMPC/MAVs</code></pre><ol><li>Build image</li></ol><pre><code class="language-none">sh build.sh</code></pre><ol><li>Test MAVs</li></ol><p>First start Docker container in the MAVs folder:</p><pre><code class="language-none">./run.sh</code></pre><p>Then, the most basic usage of MAVs is simply running the demos. For instance, demoA can be run as:</p><pre><code class="language-none">$roslaunch system demoA.launch</code></pre><p><a href="gazebo.png">Example, output</a></p><h4><a class="nav-anchor" id="Potential-Issue,-NVIDIA-driver-is-too-old-for-CUDA-10-1" href="#Potential-Issue,-NVIDIA-driver-is-too-old-for-CUDA-10-1">Potential Issue, NVIDIA driver is too old for CUDA 10</a></h4><p>If you try to run the test:</p><pre><code class="language-none">$ docker run --runtime=nvidia --rm nvidia/cuda nvidia-smi</code></pre><p>And get this error:</p><pre><code class="language-none">Unable to find image &#39;nvidia/cuda:latest&#39; locally
latest: Pulling from nvidia/cuda
898c46f3b1a1: Pull complete
63366dfa0a50: Pull complete
041d4cd74a92: Pull complete
6e1bee0f8701: Pull complete
131dbe7c254d: Pull complete
5bca6b05dcd6: Pull complete
0d286a7b6e12: Pull complete
5776d2c6371d: Pull complete
768e84e7fc24: Pull complete
Digest: sha256:eba1dc5810e40f60625ee797d618a6bd11be24cb67bc6647a4d36392202bb013
Status: Downloaded newer image for nvidia/cuda:latest
docker: Error response from daemon: OCI runtime create failed: container_linux.go:345: starting container process caused &quot;process_linux.go:424: container init caused \&quot;process_linux.go:407: running prestart hook 1 caused \\\&quot;error running hook: exit status 1, stdout: , stderr: exec command: [/usr/bin/nvidia-container-cli --load-kmods configure --ldconfig=@/sbin/ldconfig.real --device=all --compute --utility --require=cuda&gt;=10.1 brand=tesla,driver&gt;=384,driver&lt;385 brand=tesla,driver&gt;=410,driver&lt;411 --pid=25518 /var/lib/docker/overlay2/daf8349b9ffd92c040ff872e037e3afa56b93a5abeb6f2406e42fa596a88facf/merged]\\\\nnvidia-container-cli: requirement error: unsatisfied condition: brand = tesla\\\\n\\\&quot;\&quot;&quot;: unknown.</code></pre><p><em>Did you follow Step 2?</em></p><p>Because it is likely that your nvidia driver is too old to support CUDA 10 <a href="https://docs.nvidia.com/deploy/cuda-compatibility/index.html#binary-compatibility__table-toolkit-driver">see NVidia&#39;s compatibility table</a>.</p><p>To check your NVIDIA driver version:</p><pre><code class="language-none">$ nvidia-smi</code></pre><pre><code class="language-none">Sun Apr 14 09:10:14 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 384.130                Driver Version: 384.130                   |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Quadro K2200M       Off  | 00000000:01:00.0  On |                  N/A |
| N/A   45C    P8    N/A /  N/A |    437MiB /  1999MiB |      1%      Default |
+-------------------------------+----------------------+----------------------+

+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      1385      G   /usr/lib/xorg/Xorg                           189MiB |
|    0      2693      G   compiz                                        86MiB |
|    0      3162      G   ...-token=8169387D71BE805A200B4A3744EC138E    94MiB |
|    0      6728      G   ...passed-by-fd --v8-snapshot-passed-by-fd    62MiB |
+-----------------------------------------------------------------------------+</code></pre><p>If that&#39;s the case, you can either use one of the numbered 1.12 tags or upgrade your device driver to a version that supports CUDA 10. Try using using the <a href="https://developer.nvidia.com/cuda-downloads ">CUDA 10.1 Toolkit</a> to install CUDA (i.e., <em>Step 2</em>)</p><h2><a class="nav-anchor" id="Citation-1" href="#Citation-1">Citation</a></h2><p>If you find <a href="https://github.com/JuliaMPC/NLOptControl.jl">NLOptControl.jl</a> useful, please cite it:</p><pre><code class="language-none">@software{nlopt,
  author = {{Huckleberry Febbo}},
  title = {NLOptControl.jl},
  url = {https://github.com/JuliaMPC/NLOptControl.jl},
  version = {0.0.1},
  date = {2017-06-17},
}</code></pre><p>If you find <a href="https://github.com/JuliaMPC/VehicleModels.jl">VehicleModels.jl</a> useful, please cite this paper:</p><pre><code class="language-none">@Conference{Febbo2017,
  author    = {Huckleberry Febbo, Jiechao Liu, Paramsothy Jayakumar, Jeffrey L. Stein, Tulga Ersal},
  title     = {Moving Obstacle Avoidance for Large, High-Speed Autonomous Ground Vehicles},
  year      = {2017},
  publisher = {IEEE}
}</code></pre><footer><hr/><a class="next" href="tutorials/basic/"><span class="direction">Next</span><span class="title">Basic usage</span></a></footer></article></body></html>
