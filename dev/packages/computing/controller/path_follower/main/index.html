<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>path_follower · MAVs</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../../../../assets/documenter.js"></script><script src="../../../../../siteinfo.js"></script><script src="../../../../../../versions.js"></script><link href="../../../../../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../../../../../assets/style.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>MAVs</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../../../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../../../../">Home</a></li><li><span class="toctext">Usage</span><ul><li><a class="toctext" href="../../../../../tutorials/basic/">Basic usage</a></li><li><a class="toctext" href="../../../../../tutorials/developer/">Developing MAVs</a></li></ul></li><li><span class="toctext">Sensing</span><ul><li><a class="toctext" href="../../../../model/gazebo/vehicle_description/main/">vehicle_description</a></li><li><a class="toctext" href="../../../../model/gazebo/contact_sensor/main/">contact_sensor</a></li></ul></li><li><span class="toctext">Detection</span><ul><li><a class="toctext" href="../../../perception/obstacle_detector/main/">obstacle_detector</a></li></ul></li><li><span class="toctext">Vehicle model</span><ul><li><a class="toctext" href="../../../../model/chrono/ros_chrono/main/">ros_chrono</a></li></ul></li><li><span class="toctext">Planning</span><ul><li><a class="toctext" href="../../../planning/nloptcontrol_planner/main/">nloptcontrol_planner</a></li><li><a class="toctext" href="../../../planning/mavs_ros_planner/main/">mavs<em>ros</em>planner</a></li></ul></li><li><span class="toctext">Controller</span><ul><li class="current"><a class="toctext" href>path_follower</a><ul class="internal"><li><a class="toctext" href="#Inputs-1">Inputs</a></li><li><a class="toctext" href="#Output-1">Output</a></li><li><a class="toctext" href="#Logic-1">Logic</a></li></ul></li><li><a class="toctext" href="../../trajectory_follower/main/">trajectory_follower</a></li></ul></li><li><span class="toctext">Miscellaneous</span><ul><li><a class="toctext" href="../../../../system/system_shutdown/">system_shutdown</a></li><li><a class="toctext" href="../../../../system/data_logging/">data_logging</a></li><li><a class="toctext" href="../../../../model/chrono/chrono_position_broadcaster/main/">chrono<em>position</em>broadcaster</a></li><li><a class="toctext" href="../../../perception/point_cloud_converter/">point<em>cloud</em>converter</a></li></ul></li><li><span class="toctext">System demos</span><ul><li><a class="toctext" href="../../../../system/demos/demoI/">demoI</a></li><li><a class="toctext" href="../../../../system/demos/demoM/">demoM</a></li><li><a class="toctext" href="../../../../system/demos/demoK/">demoK</a></li><li><a class="toctext" href="../../../../system/demos/demoZ/">demoZ</a></li></ul></li><li><span class="toctext">Docker</span><ul><li><a class="toctext" href="../../../../../docker/workflow/">Workflow</a></li><li><a class="toctext" href="../../../../../docker/notes/">Notes</a></li></ul></li><li><a class="toctext" href="../../../../../testing/main/">Testing</a></li><li><a class="toctext" href="../../../../../issues/main/">Troubleshooting</a></li></ul></nav><article id="docs"><header><nav><ul><li>Controller</li><li><a href>path_follower</a></li></ul><a class="edit-page" href="https://github.com/JuliaMPC/MAVs/blob/master/docs/src/packages/computing/controller/path_follower/main.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>path_follower</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="path_follower-1" href="#path_follower-1">path_follower</a></h1><p>The path_follower package is to control the vehicle using Pure Pursuit (PP) controller. The logic is described as follows.</p><h2><a class="nav-anchor" id="Inputs-1" href="#Inputs-1">Inputs</a></h2><p>Following are the arguments are required by <code>path_follower.launch</code> package</p><h4><a class="nav-anchor" id="Vehicle-State-1" href="#Vehicle-State-1">Vehicle State</a></h4><table><tr><th>Name</th><th>Description</th></tr><tr><td><code>/state/x</code></td><td>global x position (m)</td></tr><tr><td><code>/state/y</code></td><td>global y position (m)</td></tr><tr><td><code>/state/psi</code></td><td>global heading angle (rad)</td></tr><tr><td><code>/state/ux</code></td><td>velocity in the x direction (vehicle frame) in (m/s)</td></tr></table><h4><a class="nav-anchor" id="Trajectories-1" href="#Trajectories-1">Trajectories</a></h4><table><tr><th>Name</th><th>Description</th></tr><tr><td><code>/trajectory/x</code></td><td>global x position trajectory (m)</td></tr><tr><td><code>/trajectory/y</code></td><td>global y position trajectory (m)</td></tr></table><h2><a class="nav-anchor" id="Output-1" href="#Output-1">Output</a></h2><p>The output of this package is as follows.</p><h4><a class="nav-anchor" id="Vehicle-State-2" href="#Vehicle-State-2">Vehicle State</a></h4><table><tr><th>Name</th><th>Description</th></tr><tr><td><code>/control/sa</code></td><td>steering angle at the tire (rad)</td></tr><tr><td><code>/control/thr</code></td><td>throttle input, range: [0, 1]</td></tr><tr><td><code>/control/brk</code></td><td>break input, range: [0, 1]</td></tr></table><h2><a class="nav-anchor" id="Logic-1" href="#Logic-1">Logic</a></h2><p>The Logic of the Pure Pursuit (PP) controller is shown in the figure below.</p><p><img src="../figures/PP_drawing.png" alt="link"/></p><p>When a path is given to the vehicle to follow, we will first draw an arc   AB with radius R<em>1, and the center of the arc is the vehicle itself. R</em>1 can is chosen to be proportional to the vehicle speed, R<em>1=Kv, with saturation R</em>max and R<em>min to avoid the case of no solution. Then, find the intersection (point D) between arc AB and the planned path, and express the position of point D as (x</em>D, y<em>D) using the vehicle coordinate system. Point D is the position where the vehicle wants to arrive next. To command the vehicle to head towards point D, we fit another arc CD which passes through the current vehicle position (0, 0) and (x</em>D, y<em>D), and the direction of the arc at (0, 0) is straight up. The radius of the arc CD is R</em>2, which is also the radius of curvature of the real vehicle path. Then, the relationship between R2 and (x<em>D, y</em>D) can be expressed as</p><p><img src="../figures/eq1.png" alt="link"/></p><p>Then we have</p><p><img src="../figures/eq2.png" alt="link"/></p><p>The radius of curvature R_2 is closely related to the steering angle as shown in the figure below. Point E is the instantaneous rotation center of the vehicle. </p><p><img src="../figures/curvature.png" alt="link"/></p><p>Finally, assume there is no slip between tires and the ground. The relationship between the steering angle and the radius of curvature R_2 is</p><p><img src="../figures/eq3.png" alt="link"/></p><p>Where L is the wheelbase.</p><footer><hr/><a class="previous" href="../../../planning/mavs_ros_planner/main/"><span class="direction">Previous</span><span class="title">mavs<em>ros</em>planner</span></a><a class="next" href="../../trajectory_follower/main/"><span class="direction">Next</span><span class="title">trajectory_follower</span></a></footer></article></body></html>
